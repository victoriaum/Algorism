### Select

##### 조건에 맞는 도서 리스트 출력하기
+ DATE FORMAT 유의할 것
```
SELECT BOOK_ID, DATE_FORMAT(PUBLISHED_DATE,'%Y-%m-%d') AS PUBLISHED_DATE FROM BOOK WHERE CATEGORY='인문' AND PUBLISHED_DATE LIKE '2021%' ORDER BY PUBLISHED_DATE ASC;
```

##### 재구매가 일어난 상품과 회원 리스트 구하기
+ 재구매인 것만 나타내야 한다.
+ GROUP BY와 HAVING을 사용하는 문제
```
SELECT USER_ID, PRODUCT_ID FROM ONLINE_SALE GROUP BY USER_ID, PRODUCT_ID HAVING COUNT(ONLINE_SALE_ID)>1 ORDER BY USER_ID ASC, PRODUCT_ID DESC;
```

##### 오프라인/온라인 판매 데이터 통합하기
```
SELECT DATE_FORMAT(SALES_DATE,'%Y-%m-%d'), PRODUCT_ID, USER_ID, SALES_AMOUNT FROM (
SELECT SALES_DATE, PRODUCT_ID, USER_ID, SALES_AMOUNT FROM ONLINE_SALE
UNION ALL
select SALES_DATE, PRODUCT_ID, NULL AS USER_ID, SALES_AMOUNT from OFFLINE_SALE
) AS T
WHERE SALES_DATE LIKE '2022-03%'
ORDER BY SALES_DATE ASC, PRODUCT_ID ASC, USER_ID ASC
```

##### 조건에 맞는 회원수 구하기
```
SELECT COUNT(*) AS USERS FROM USER_INFO WHERE AGE BETWEEN 20 AND 29 AND JOINED LIKE '2021%'
```

##### 상위 n개 레코드
+ MYSQL에서는 ```LIMIT```를 이용하고 MSSQL에서는 SELECT 당시에 ```TOP```으로 위에 자료를 가지고 온다.
```
SELECT NAME FROM ANIMAL_INS ORDER BY DATETIME LIMIT 0,1
```

##### 여러 기준으로 정렬하기
```
SELECT ANIMAL_ID, NAME, DATETIME FROM ANIMAL_INS ORDER BY NAME ASC, DATETIME DESC;
```

##### 여러 기준으로 정렬하기
```
SELECT ANIMAL_ID, NAME, DATETIME FROM ANIMAL_INS ORDER BY NAME ASC, DATETIME DESC;
```

##### 어린 동물 찾기
```
SELECT ANIMAL_ID, NAME FROM ANIMAL_INS WHERE INTAKE_CONDITION<>'Aged'
```

##### 아픈 동물 찾기
```
SELECT ANIMAL_ID, NAME FROM ANIMAL_INS WHERE INTAKE_CONDITION='Sick'
```

##### 아픈 동물 찾기
```
SELECT ANIMAL_ID, NAME FROM ANIMAL_INS WHERE INTAKE_CONDITION='Sick'
```